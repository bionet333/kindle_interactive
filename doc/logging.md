# Документация: Логирование

## Обзор

Для диагностики проблемы, связанной с отсутствием обновления контента на читалке, в приложение была интегрирована система логирования. Это позволяет отслеживать поток данных от интерфейса редактора до веб-сервера в реальном времени и быстро выявлять причину сбоя.

## Техническая реализация

-   **Фасад**: Используется стандартный крейт `log`, предоставляющий макросы (`info!`, `warn!`, `error!`).
-   **Плагин**: Интегрирован плагин `tauri-plugin-log` для Tauri v2. Он направляет логи в различные выходы.

## Настройка

Плагин настроен в файле `src-tauri/src/lib.rs` для вывода логов в три места одновременно:

1.  **`LogTarget::Stdout`**: Стандартный вывод консоли, в которой вы запускаете `cargo tauri dev`. Это основной источник для отслеживания событий бэкенда.
2.  **`LogTarget::Webview`**: Консоль разработчика в окне приложения (можно открыть по F12 или через контекстное меню). Полезно для отладки событий, инициированных фронтендом.
3.  **`LogTarget::LogDir`**: Файл на диске. Логи сохраняются в директории логов вашего приложения, что полезно для анализа проблем после закрытия приложения.

## Как использовать для диагностики

1.  Запустите приложение в режиме разработки: `cargo tauri dev`.
2.  Откройте терминал, в котором запущен процесс. Здесь вы увидите логи от Rust-бэкенда.
3.  Откройте читалку по IP-адресу, указанному в приложении.
4.  Измените текст в редакторе и нажмите кнопку "Сохранить и обновить читалку".

### Ожидаемое поведение в логах

При нажатии на кнопку вы должны увидеть в терминале следующие сообщения:

```
[INFO] Attempting to set new text (length: XXX)
[INFO] Successfully updated shared text.
```

Это подтверждает, что фронтенд успешно вызвал команду бэкенда и состояние было обновлено.

Каждые 3 секунды (интервал опроса читалки) вы должны видеть сообщения от сервера:

```
[INFO] Polling request received for /api/content
```

Это подтверждает, что читалка успешно опрашивает сервер на предмет обновлений.

Если вы видите эти логи, но контент на читалке не обновляется, проблема, скорее всего, связана с кешированием на устройстве или ошибкой в JavaScript-клиенте. Если логов нет, значит, вызов от фронтенда не доходит до бэкенда, или сам сервер не получает запросы.
